Sure! I can help you with that. Here's an example Go code using the github.com/segmentio/kafka-go package to interact with Kafka, along with the required Docker images confluentinc/cp-kafka:latest and confluentinc/cp-zookeeper:latest.

Before we begin, make sure you have Docker installed on your system and the necessary Go dependencies installed (github.com/segmentio/kafka-go).

Here's an example code that demonstrates how to produce and consume messages from Kafka using the kafka-go package:

go
package main

import (
	"context"
	"fmt"
	"log"
	"time"

	"github.com/segmentio/kafka-go"
)

func main() {
	// Create a Kafka writer configuration.
	kafkaWriter := kafka.Writer{
		Addr:      kafka.TCP("localhost:9092"),
		Topic:     "my-topic",
		Balancer:  &kafka.LeastBytes{},
		BatchSize: 10,
	}

	// Create a Kafka reader configuration.
	kafkaReader := kafka.Reader{
		Brokers:   []string{"localhost:9092"},
		Topic:     "my-topic",
		Partition: 0,
		MinBytes:  10e3,
		MaxBytes:  10e6,
		GroupID:   "my-group",
	}

	// Produce a message to Kafka.
	message := kafka.Message{
		Key:   []byte("key"),
		Value: []byte("Hello, Kafka!"),
		Time:  time.Now(),
	}
	err := kafkaWriter.WriteMessages(context.Background(), message)
	if err != nil {
		log.Fatal("Failed to write message:", err)
	}

	// Consume messages from Kafka.
	for {
		msg, err := kafkaReader.ReadMessage(context.Background())
		if err != nil {
			log.Fatal("Failed to read message:", err)
		}
		fmt.Printf("Received message: %s\n", string(msg.Value))
	}
}
Please note that in the above code, we assume that you have Kafka running locally on localhost:9092. If your Kafka broker is running on a different address or port, make sure to update the code accordingly.

To run this code with the required Docker images, you can follow these steps:

Start ZooKeeper container:
sh
docker run -d --name=zookeeper -p 2181:2181 confluentinc/cp-zookeeper:latest
Wait for ZooKeeper to start up (it usually takes a few seconds).

Start Kafka container:

sh
docker run -d --name=kafka -p 9092:9092 --link zookeeper:zookeeper confluentinc/cp-kafka:latest
Wait for Kafka to start up (again, it usually takes a few seconds).

Build and run the Go code:

sh
go run main.go
The code will produce a message to the "my-topic" topic and continuously consume messages from the same topic.

Remember to replace my-topic with the actual
[Network Error]